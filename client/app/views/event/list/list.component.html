<header class="form horizontal">
  <div appFloatingLabel *ngIf="user && (user.role >= roles.Admin || (user.role >= roles.Secretariat && user.club.id === tournament.club.id))">
    <label for="filter"><fa name="filter" fw="true"></fa><span translate>Filter by:</span></label>
    <select id="filter" name="filter" [(ngModel)]="selectedDiscipline">
      <option [ngValue]="null" translate>No filter</option>
      <option *ngFor="let discipline of disciplines" [ngValue]="discipline">{{ discipline.name }}</option>
    </select>
  </div>
  <div>
    <app-slide-toggle [onLabel]="trainingVisibleLabel" [offLabel]="trainingHiddenLabel" [(ngModel)]="showTraining"></app-slide-toggle>
  </div>
</header>

<section class="table-responsive">
  <table *ngIf="tournament && schedule.length" role="list">
    <thead>
      <tr>
        <th translate>Start</th>
        <th translate class="visible-wide">Time</th>
        <th translate>Team</th>
        <th class="visible-wide" translate>Division</th>
        <th class="visible-wide" translate>Discipline</th>
        <th translate>Score</th>
        <th *ngIf="user && (user.role >= roles.Admin || (user.role >= roles.Secretariat && user.club.id === tournament.club.id))" class="actions"></th>
      </tr>
    </thead>
    <tbody *ngFor="let item of schedule; let i = index;" role="listitem"
           [ngClass]="{isPublished: item.publishTime != null, isStarted: item.startTime, unimportant: item.type === types.Training, isCurrent: item.startTime && !item.endTime && !item.publishTime}">

      <!-- View details wide screen -->
      <tr *ngIf="selected !== item && (!selectedDiscipline || selectedDiscipline.id === item.discipline.id) && item.type !== participationTypes.Training || showTraining === true" (click)="select(item)">
        <td *ngIf="item.type === participationTypes.Training"></td>
        <td *ngIf="item.type === participationTypes.Live">#{{ item.startNumber + 1 }}</td>
        <td class="visible-wide" [innerHtml]="startTime(item)"></td>
        <td>{{ item.team.name }} </td>
        <td class="visible-wide"><b *ngIf="item.team.class === classes.TeamGym && item.type === types.Live">TG: </b>{{ division(item.team) }}</td>
        <td class="visible-wide">{{ item.discipline.name }}</td>
        <td *ngIf="item.type === types.Live">{{ score(item) | number:'1.3-3' }}</td>
        <td *ngIf="item.type === types.Training"></td>
        <td *ngIf="user && (user.role >= roles.Admin || (user.role >= roles.Secretariat && user.club.id === tournament.club.id))" class="actions" rowspan="2">
          <button *ngIf="canStart(item, i)" (click)="start(item, $event)" [title]="'Start' | translate">
            <fa name="play" fw="true"></fa>
          </button>
          <button *ngIf="item.startTime != null && item.endTime == null && score(item) == 0" (click)="stop(item, $event)" [title]="'Stop' | translate">
            <fa name="stop" fw="true"></fa>
          </button>
          <button *ngIf="score(item) > 0 && item.publishTime == null" (click)="publish(item, $event)" [title]="'Publish' | translate">
            <fa name="share" fw="true"></fa>
          </button>
        </td>
      </tr>

      <!-- View details narrow screen -->
      <tr *ngIf="selected !== item && (!selectedDiscipline || selectedDiscipline.id === item.discipline.id)" (click)="select(item)" class="visible-narrow details">
        <td>{{ startTime(item) }}</td>
        <td><small>{{ division(item.team) }} - {{ item.discipline.name }}</small></td>
        <td>&nbsp;</td>
      </tr>

      <!-- Score editor -->
      <tr *ngIf="selected === item">
        <td colspan="7" class="editor">
          <app-scoreboard [participant]="item" (onClose)="closeEditor()"></app-scoreboard>
        </td>
      </tr>

      <!-- Day divider -->
      <tr *ngIf="isNewDay(item)">
        <td colspan="7" class="day-split">
          {{ startDate(schedule[i+1]) | translate }}
        </td>
      </tr>
    </tbody>
  </table>
</section>
