<header *ngIf="tournament">
  <small>{{ tournament.startDate | date: 'dd.MM' }} - {{ tournament.endDate | date: 'dd.MM' }} {{ tournament.endDate | date: 'yyyy' }}</small>
  <h2 class="pull-left">{{ tournament.name }}</h2>
  <button type="button" class="pull-right primary raised" [routerLink]="['/results', tournament.id]">
    <app-fa name="trophy" fw="true"></app-fa>
    <span translate>Results </span>
  </button>
  <button type="button" class="pull-right primary raised" *appIfAuth="'Secretariat'" [routerLink]="['/display', tournament.id]">
    <app-fa name="tv" fw="true"></app-fa>
    <span translate>Display </span>
  </button>
  <button type="button" class="pull-right" *appIfAuth="'Organizer'" [routerLink]="['/configure/tournament', tournament.id]">
    <app-fa name="cog" fw="true"></app-fa>
    <span translate>Settings </span>
  </button>
</header>

<section *ngIf="tournament"><pre [innerHTML]="description | MarkdownToHtml"></pre></section>
<section class="table-responsive">
  <table *ngIf="tournament && schedule.length" role="list">
    <thead>
      <tr>
        <th translate>Start #</th>
        <th translate>Team</th>
        <th class="visible-wide" translate>Division</th>
        <th class="visible-wide" translate>Discipline</th>
        <th translate>Score</th>
        <th *ngIf="user && (user.role >= roles.Admin || (user.role >= roles.Secretariat && user.club.id === tournament.createdBy.club.id))" class="actions"></th>
      </tr>
    </thead>
    <tbody *ngFor="let item of schedule; let i = index;" [ngClass]="{isPublished: item.publishTime != null, isStarted: item.startTime, isCurrent: item.startTime && !item.endTime && !item.publishTime}">
      <tr *ngIf="selected !== item" (click)="select(item)" role="listitem">
        <td>{{ item.startNumber }}</td>
        <td>{{ item.team.name }} </td>
        <td class="visible-wide">{{ division(item.team) }}</td>
        <td class="visible-wide">{{ item.discipline.name }}</td>
        <td>{{ score(item) | number:'1.3-3' }}</td>
        <td *ngIf="user && (user.role >= roles.Admin || (user.role >= roles.Secretariat && user.club.id === tournament.createdBy.club.id))" class="actions">
          <button *ngIf="canStart(item, i)" (click)="start(item, $event)" [title]="'Start' | translate">
            <app-fa name="play" fw="true"></app-fa>
          </button>
          <button *ngIf="item.startTime != null && item.endTime == null && score(item) == 0" (click)="stop(item, $event)" [title]="'Stop' | translate">
            <app-fa name="stop" fw="true"></app-fa>
          </button>
          <button *ngIf="score(item) > 0 && item.publishTime == null" (click)="publish(item, $event)" [title]="'Publish' | translate">
            <app-fa name="share" fw="true"></app-fa>
          </button>
        </td>
      </tr>
      <tr *ngIf="selected !== item" (click)="select(item)" class="visible-narrow details">
        <td>&nbsp;</td>
        <td><small>{{ division(item.team) }} - {{ item.discipline.name }}</small></td>
        <td>&nbsp;</td>
        <td *ngIf="user && (user.role >= roles.Admin || (user.role >= roles.Secretariat && user.club.id === tournament.createdBy.club.id))">&nbsp;</td>
      </tr>
      <tr *ngIf="selected === item">
        <td colspan="6" class="editor">
          <scoreboard [participant]="item" (onClose)="closeEditor()"></scoreboard>
        </td>
      </tr>
    </tbody>
  </table>
</section>
